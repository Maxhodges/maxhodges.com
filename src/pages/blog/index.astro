---
import { Picture } from "astro:assets";
import { getCollection } from "astro:content";
import SiteLayout from "../../layouts/SiteLayout.astro";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

const formatDate = (date) =>
  new Intl.DateTimeFormat("en-US", {
    month: "short",
    day: "2-digit",
    year: "numeric",
  }).format(date);
---

<SiteLayout title="Max Hodges â€” Blog" breadcrumb="Home / Blog">
  <section class="grid gap-8">
    <div class="flex flex-wrap items-end justify-between gap-6">
      <div>
        <h1 class="font-[var(--font-display)] text-4xl leading-tight sm:text-5xl">
          Blog
        </h1>
        <p class="mt-3 max-w-xl text-sm uppercase tracking-[0.2em] text-[color:var(--sea)]">
          Notes, interviews, and conversations about the image.
        </p>
      </div>
    </div>

    <div class="grid gap-6 md:grid-cols-2">
      {
        posts.map((post) => (
          <a
            href={`/blog/${post.slug}`}
            class="group relative overflow-hidden rounded-3xl border border-white/10 bg-black/30 shadow-[0_20px_60px_rgba(0,0,0,0.45)] transition hover:-translate-y-1 hover:shadow-[0_30px_70px_rgba(0,0,0,0.6)]"
          >
            <div class="aspect-[4/3] overflow-hidden">
              <Picture
                src={post.data.heroImage}
                alt={post.data.title}
                widths={[480, 960, 1440]}
                formats={["webp", "jpeg"]}
                sizes="(max-width: 768px) 92vw, (max-width: 1200px) 45vw, 40vw"
                pictureAttributes={{ class: "h-full w-full block" }}
                class="h-full w-full object-cover transition duration-500 group-hover:scale-[1.03]"
                loading="lazy"
              />
            </div>
            <div class="grid gap-3 bg-[#141311] px-6 py-5 text-[color:var(--ink)]">
              <div class="text-xs uppercase tracking-[0.3em] text-[color:var(--sea)]">
                {formatDate(post.data.pubDate)}
              </div>
              <div class="font-[var(--font-display)] text-2xl">
                {post.data.title}
              </div>
              <p class="text-sm text-white/70">
                {post.data.description}
              </p>
            </div>
          </a>
        ))
      }
    </div>
  </section>
</SiteLayout>
